<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Expense & Savings Tracker</title>
  <style>
    :root {
      --bg: #fdfcfa;
      --text: #2c1e1a;
      --box: #ffffff;
      --accent: #8b5e3c;
      --success: #d4edda;
      --error: #f8d7da;
    }
    body.dark {
      --bg: #1e140f;
      --text: #f8f6f4;
      --box: #2a1b15;
    }
    body {
      background: var(--bg);
      color: var(--text);
      font-family: sans-serif;
      padding: 10px;
      margin: 0;
    }
    h1, h2 { text-align: center; }
    .section {
      background: var(--box);
      padding: 15px;
      margin-bottom: 20px;
      border-radius: 10px;
      box-shadow: 0 0 5px rgba(0,0,0,0.1);
    }
    input, select, button {
      padding: 10px;
      margin-top: 5px;
      margin-bottom: 10px;
      width: 100%;
      border-radius: 8px;
      border: 1px solid #ccc;
      box-sizing: border-box;
    }
    button {
      background: var(--accent);
      color: white;
      border: none;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 10px;
    }
    td, th {
      border: 1px solid #ccc;
      padding: 8px;
      font-size: 14px;
    }
   .goal-green {
  background: var(--success);
  color: #1e392a; /* Dark green text for readability */
}
.goal-red {
  background: var(--error);
  color: #5a1a1a; /* Dark red text for readability */
}

    .progress-bar {
      height: 100%;
      background: var(--accent);
      transition: width 0.3s ease;
    }
    .tabs button {
      flex: 1;
      background: var(--accent);
      color: white;
      border: none;
      margin: 2px;
      padding: 10px;
    }
    .tabs {
      display: flex;
      flex-wrap: wrap;
      margin-bottom: 10px;
    }
    .nav-toggle {
      position: fixed;
      top: 10px;
      right: 10px;
      width: 40px;
      height: 40px;
      background: var(--accent);
      color: white;
      font-size: 18px;
      border-radius: 50%;
      border: none;
    }
    .toast {
      position: fixed;
      bottom: 10px;
      left: 50%;
      transform: translateX(-50%);
      background: var(--accent);
      color: white;
      padding: 10px 20px;
      border-radius: 20px;
      display: none;
      z-index: 1000;
    }
    .hidden { display: none; }
  </style>
</head>
<body onload="showTab('allowance')">
  <button class="nav-toggle" onclick="document.body.classList.toggle('dark')">ðŸŒ“</button>
  <div class="toast" id="toast"></div>
  <h1>Expense & Savings Tracker</h1>

  <div class="tabs">
    <button onclick="showTab('allowance')">Allowance</button>
    <button onclick="showTab('expenses')">Expenses</button>
    <button onclick="showTab('savings')">Savings</button>
    <button onclick="showTab('goals')">Goals</button>
    <button onclick="showTab('completed')">Completed</button>
    <button onclick="showTab('log')">Expense Log</button>
  </div>

  <div id="allowance" class="section">
    <h2>Set Allowance</h2>
    <input type="number" id="allowanceAmount" placeholder="Amount">
    <select id="allowanceType">
      <option value="daily">Daily</option>
      <option value="weekly">Weekly</option>
      <option value="monthly">Monthly</option>
    </select>
    <button onclick="setAllowance()">Set Allowance</button>
  </div>
  <div id="expenses" class="section hidden">
    <h2>Add Expense</h2>
    <input type="number" id="expenseAmount" placeholder="Amount">
    <select id="expenseCategory">
      <option value="FOOD">FOOD</option>
      <option value="DRINKS">DRINKS</option>
      <option value="TRANSPO">TRANSPO</option>
      <option value="OTHERS">OTHERS</option>
    </select>
    <button onclick="addExpense()">Add Expense</button>
    <button onclick="resetExpenses()">Reset Expenses</button>
    <div id="expenseList"></div>
  </div>

  <div id="savings" class="section hidden">
    <h2>Total Savings: <span id="totalSavings" style="font-weight:bold;"></span></h2>
    <input type="number" id="manualSavings" placeholder="Add to Savings">
    <button onclick="addManualSavings()">Add to Savings</button>
    <button onclick="transferToSavings()">Transfer Remaining Allowance</button>
    <button onclick="resetSavings()">Reset Savings</button>
  </div>

  <div id="goals" class="section hidden">
    <h2>Goals</h2>
    <input type="text" id="goalName" placeholder="Goal name">
    <input type="number" id="goalPrice" placeholder="Goal amount">
    <button onclick="addGoal()">Add Goal</button>
    <div id="goalList"></div>
  </div>

  <div id="completed" class="section hidden">
    <h2>Completed Goals</h2>
    <button onclick="resetCompleted()">Reset Completed Goals</button>
    <div id="completedList"></div>
  </div>

  <div id="log" class="section hidden">
    <h2>Expense Log</h2>
    <div id="expenseLog"></div>
  </div>
<script>
  let allowance = JSON.parse(localStorage.getItem('allowance')) || { amount: 0, type: 'daily' };
  let expenses = JSON.parse(localStorage.getItem('expenses')) || [];
  let savings = parseFloat(localStorage.getItem('savings') || '0');
  let goals = JSON.parse(localStorage.getItem('goals') || '[]');
  let completedGoals = JSON.parse(localStorage.getItem('completedGoals') || '[]');

function showTab(id) {
  // Hide all sections
  document.querySelectorAll('.section').forEach(section => {
    section.classList.add('hidden');
  });

  // Show the selected one
  const target = document.getElementById(id);
  if (target) {
    target.classList.remove('hidden');
  }

  // Optional: refresh data per section
  if (id === 'expenses') renderExpenses();
  if (id === 'savings') updateSavings();
  if (id === 'goals') renderGoals();
  if (id === 'completed') renderCompletedGoals();
  if (id === 'log') renderExpenseLog();
}




  function showToast(msg) {
    const toast = document.getElementById('toast');
    toast.textContent = msg;
    toast.style.display = 'block';
    setTimeout(() => toast.style.display = 'none', 2000);
  }

  function setAllowance() {
    allowance.amount = parseFloat(document.getElementById('allowanceAmount').value);
    allowance.type = document.getElementById('allowanceType').value;
    localStorage.setItem('allowance', JSON.stringify(allowance));
    showToast('âœ… Allowance set');
  }

  function addExpense() {
    const amount = parseFloat(document.getElementById('expenseAmount').value);
    const category = document.getElementById('expenseCategory').value;
    if (isNaN(amount) || amount <= 0) return showToast('âŒ Invalid amount');
    const todaySpent = expenses.reduce((sum, e) => e.date === today() ? sum + e.amount : sum, 0);
    if ((todaySpent + amount) > allowance.amount) {
      showToast('âŒ Not enough allowance');
      return;
    }
    expenses.push({ amount, category, date: today() });
    localStorage.setItem('expenses', JSON.stringify(expenses));
    showToast('âœ… Expense added');
    renderExpenses();
  }

  function renderExpenses() {
    const list = document.getElementById('expenseList');
    const todayExpenses = expenses.filter(e => e.date === today());
    if (!todayExpenses.length) return list.innerHTML = '<p>No expenses today</p>';
    let html = '<table><tr><th>Amount</th><th>Category</th></tr>';
    todayExpenses.forEach(e => {
      html += `<tr><td>${e.amount}</td><td>${e.category}</td></tr>`;
    });
    html += '</table>';
    list.innerHTML = html;
  }

  function resetExpenses() {
    expenses = expenses.filter(e => e.date !== today());
    localStorage.setItem('expenses', JSON.stringify(expenses));
    showToast('âœ… Expenses reset');
    renderExpenses();
  }

  function addManualSavings() {
    const amt = parseFloat(document.getElementById('manualSavings').value);
    if (!amt || amt <= 0) return showToast('âŒ Invalid amount');
    savings += amt;
    localStorage.setItem('savings', savings);
    showToast('âœ… Saved');
    updateSavings();
  }

  function transferToSavings() {
    const todaySpent = expenses.reduce((sum, e) => e.date === today() ? sum + e.amount : sum, 0);
    const remaining = allowance.amount - todaySpent;
    if (remaining <= 0) return showToast('âŒ No remaining allowance');
    savings += remaining;
    localStorage.setItem('savings', savings);
    showToast('âœ… Remaining allowance saved');
    resetExpenses();
    updateSavings();
  }

  function updateSavings() {
    document.getElementById('totalSavings').textContent = savings.toFixed(2);
  }

  function resetSavings() {
    savings = 0;
    localStorage.setItem('savings', savings);
    showToast('âœ… Savings reset');
    updateSavings();
  }

  function addGoal() {
    const name = document.getElementById('goalName').value;
    const price = parseFloat(document.getElementById('goalPrice').value);
    if (!name || isNaN(price)) return showToast('âŒ Invalid goal');
    goals.push({ name, price });
    localStorage.setItem('goals', JSON.stringify(goals));
    showToast('âœ… Goal added');
    renderGoals();
  }

function renderGoals() {
  const container = document.getElementById('goalList');
  container.innerHTML = '';
  goals.forEach((goal, index) => {
    const percent = Math.min(100, (savings / goal.price) * 100);
    const complete = savings >= goal.price;
    container.innerHTML += `
      <div class="${complete ? 'goal-green' : 'goal-red'}" style="margin-bottom:10px;padding:10px;border-radius:8px">
        <b>${goal.name}</b> - â‚±${goal.price}
        ${!complete ? `
          <div class="progress">
            <div class="progress-bar" style="width:${Math.max(5, percent)}%"></div>
          </div>` : ''}
        ${complete ? `<button onclick="completeGoal(${index})">DONE</button>` : ''}
      </div>
    `;
  });
}


  function completeGoal(index) {
    const goal = goals[index];
    if (savings >= goal.price) {
      savings -= goal.price;
      completedGoals.push(goal);
      goals.splice(index, 1);
      localStorage.setItem('savings', savings);
      localStorage.setItem('completedGoals', JSON.stringify(completedGoals));
      localStorage.setItem('goals', JSON.stringify(goals));
      showToast('âœ… Goal completed');
      renderGoals();
      updateSavings();
      renderCompletedGoals();
    }
  }

  function renderCompletedGoals() {
    const container = document.getElementById('completedList');
    if (!completedGoals.length) {
      container.innerHTML = '<p>No completed goals</p>';
      return;
    }
    container.innerHTML = '<ul>' + completedGoals.map(g => `<li>${g.name} - â‚±${g.price}</li>`).join('') + '</ul>';
  }

  function resetCompleted() {
    completedGoals = [];
    localStorage.setItem('completedGoals', JSON.stringify(completedGoals));
    showToast('âœ… Completed goals reset');
    renderCompletedGoals();
  }

function renderExpenseLog() {
  const logDiv = document.getElementById('expenseLog');
  if (!expenses.length) {
    logDiv.innerHTML = '<p>No expenses yet.</p>';
    return;
  }
  // 1. Group expenses by date
  let grouped = {};
  let currentMonth = new Date().toISOString().slice(0, 7); // e.g., "2025-07"
  let monthlyTotal = 0;
  expenses.forEach(e => {
    if (!grouped[e.date]) grouped[e.date] = [];
    grouped[e.date].push(e);
    // 2. If expense is from current month, add to monthly total
    if (e.date.startsWith(currentMonth)) {
      monthlyTotal += e.amount;
    }
  });
  // 3. Render log
  let html = `<h3>Total Expenses for ${currentMonth}: â‚±${monthlyTotal.toFixed(2)}</h3>`;
  for (let date in grouped) {
    html += `<h4>${date}</h4><table><tr><th>Amount</th><th>Category</th></tr>`;
    grouped[date].forEach(e => {
      html += `<tr><td>${e.amount}</td><td>${e.category}</td></tr>`;
    });
    html += '</table>';
  }

  logDiv.innerHTML = html;
}

    }
    let grouped = {};
    expenses.forEach(e => {
      if (!grouped[e.date]) grouped[e.date] = [];
      grouped[e.date].push(e);
    });
    let html = '';
    for (let date in grouped) {
      html += `<h3>${date}</h3><table><tr><th>Amount</th><th>Category</th></tr>`;
      grouped[date].forEach(e => {
        html += `<tr><td>${e.amount}</td><td>${e.category}</td></tr>`;
      });
      html += '</table>';
    }
    logDiv.innerHTML = html;
  }

  function today() {
    return new Date().toISOString().split('T')[0];
  }

  // Load initial
  updateSavings();
  renderGoals();
  renderCompletedGoals();
  renderExpenses();
</script>
</body>
</html>
